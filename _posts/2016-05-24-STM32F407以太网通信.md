---
layout: post
title:  "STM32F407以太网通信"
date:   2016-05-24
---


前两天公司买了正点原子的STM32F4探索者开发板，功能挺多的。

现阶段网络通信方面的程序就用linux上C语言熟练一点，重点是可以参考的例程比较多，用windows开发一点信心也没有了。我还不太清楚能不能通过网络远程执行单片机上面的命令，感觉未必可行吧，远程计算机直接控制单片机的运作，除非官方提供实现方法，否则肯定得像黑客一样去破解了。

现阶段只是进行最为简单的通信。单片机上共有四个按键KEY0，KEY1，KEY2，KEY_UP。两个可以控制的led灯，一黄一红。

现在单片机中下载的程序使用TCP通信，可以实现按键后发送代表键值的字符1[KEY0]，2[KEY1]，3[KEY2]到与之连接的客户端（远程计算机）上，并且直接控制led的开关。按KEY0后红灯取反，按KEY1后黄灯取反，按KEY2后两个灯取反。

![stm32f407-client](stm32f407client.png)

现在客户端上的程序接收到代表键值字符是，向服务器（单片机）发送自己定义的用于控制led的字符，并且计算出led的状态，打印出来。

现在一边用windows xp的keil 5往stm32f407开发板上烧写程序，一边用ubuntu写客户端程序，进行测试，出了问题时不时的用wireshark抓个包，调试一下程序。
